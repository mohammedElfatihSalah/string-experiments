[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
I0203 22:23:41.654584 140663120705408 run.py:118] Using CLRS21 spec: {'train': {'num_samples': 1000, 'length': 16, 'seed': 1}, 'val': {'num_samples': 32, 'length': 64, 'seed': 2}, 'test': {'num_samples': 32, 'length': 64, 'seed': 3}}
I0203 22:23:45.566480 140663120705408 xla_bridge.py:231] Unable to initialize backend 'tpu_driver': NOT_FOUND: Unable to find driver in registry given worker:
2022-02-03 22:23:45.578907: E external/org_tensorflow/tensorflow/stream_executor/cuda/cuda_driver.cc:271] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
I0203 22:23:45.579262 140663120705408 xla_bridge.py:231] Unable to initialize backend 'gpu': FAILED_PRECONDITION: No visible GPU devices.
I0203 22:23:45.580054 140663120705408 xla_bridge.py:231] Unable to initialize backend 'tpu': INVALID_ARGUMENT: TpuPlatform is not available.
W0203 22:23:45.580283 140663120705408 xla_bridge.py:235] No GPU/TPU found, falling back to CPU. (Set TF_CPP_MIN_LOG_LEVEL=0 and rerun for more info.)
manual >>  True
mid size >>  32
out size >>  32
adj shape >>  (32, 20, 20)
max
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
manual >>  True
mid size >>  32
out size >>  32
adj shape >>  (32, 20, 20)
max
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
manual >>  True
mid size >>  32
out size >>  32
adj shape >>  (32, 20, 20)
max
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
manual >>  True
mid size >>  32
out size >>  32
adj shape >>  (32, 20, 20)
max
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
manual >>  True
mid size >>  32
out size >>  32
adj shape >>  (32, 20, 20)
max
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
manual >>  True
mid size >>  32
out size >>  32
adj shape >>  (32, 20, 20)
max
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
manual >>  True
mid size >>  32
out size >>  32
adj shape >>  (32, 20, 20)
max
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 20)
I0203 22:24:20.506766 140663120705408 run.py:190] Compiled feedback step in 34.944668 s.
I0203 22:24:27.735724 140663120705408 run.py:203] (train) step 0: {'average_accuracy': 0.5545700571895426, 'average_shift': 3.125}
manual >>  True
mid size >>  32
out size >>  32
adj shape >>  (32, 80, 80)
max
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 80)
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 80)
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 80)
manual >>  True
mid size >>  32
out size >>  32
adj shape >>  (32, 80, 80)
max
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 80)
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 80)
inside max_i_j line: [734] baseline_2.py
prev_hint shape >>  (32, 80)
I0203 22:24:50.479560 140663120705408 run.py:210] (val) step 0: {'average_accuracy': 0.5567652533965446, 'average_shift': 20.6875}
I0203 22:24:50.479845 140663120705408 run.py:216] Saving new checkpoint for average accuracy...
I0203 22:24:50.486824 140663120705408 run.py:221] Saving new checkpoint for average shift...
I0203 22:25:00.302584 140663120705408 run.py:203] (train) step 10: {'average_accuracy': 0.4472421697025025, 'average_shift': 1.71875}
I0203 22:25:02.604725 140663120705408 run.py:210] (val) step 10: {'average_accuracy': 0.4870006546256955, 'average_shift': 7.90625}
I0203 22:25:02.604978 140663120705408 run.py:221] Saving new checkpoint for average shift...
I0203 22:25:15.373647 140663120705408 run.py:203] (train) step 20: {'average_accuracy': 0.569189133986928, 'average_shift': 4.09375}
I0203 22:25:17.267330 140663120705408 run.py:210] (val) step 20: {'average_accuracy': 0.559356900795198, 'average_shift': 22.71875}
I0203 22:25:17.269695 140663120705408 run.py:216] Saving new checkpoint for average accuracy...
I0203 22:25:29.069292 140663120705408 run.py:203] (train) step 30: {'average_accuracy': 0.5607966571987953, 'average_shift': 3.1875}
I0203 22:25:31.197839 140663120705408 run.py:210] (val) step 30: {'average_accuracy': 0.5784992905250277, 'average_shift': 18.84375}
I0203 22:25:31.200432 140663120705408 run.py:216] Saving new checkpoint for average accuracy...
I0203 22:25:43.616183 140663120705408 run.py:203] (train) step 40: {'average_accuracy': 0.587333062077886, 'average_shift': 2.15625}
I0203 22:25:45.298990 140663120705408 run.py:210] (val) step 40: {'average_accuracy': 0.5829209070995441, 'average_shift': 15.4375}
I0203 22:25:45.299851 140663120705408 run.py:216] Saving new checkpoint for average accuracy...
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/content/drive/MyDrive/Final Project/new_clrs/clrs/examples/run.py", line 298, in <module>
    # wandb.log({'test_accuracy': test_stats['match'], 'average accuracy': a, 'average shift':s,})
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/content/drive/MyDrive/Final Project/new_clrs/clrs/examples/run.py", line 187, in main
    t = time.time()
  File "/content/drive/MyDrive/Final Project/new_clrs/clrs/_src/baselines_2.py", line 964, in feedback
    feedback)
  File "/content/drive/MyDrive/Final Project/new_clrs/clrs/_src/baselines_2.py", line 1135, in update
    lss, grads = jax.value_and_grad(loss)(params, feedback)
  File "/usr/local/lib/python3.7/dist-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/jax/_src/api.py", line 993, in value_and_grad_f
    ans, vjp_py = _vjp(f_partial, *dyn_args, reduce_axes=reduce_axes)
  File "/usr/local/lib/python3.7/dist-packages/jax/_src/api.py", line 2313, in _vjp
    flat_fun, primals_flat, reduce_axes=reduce_axes)
  File "/usr/local/lib/python3.7/dist-packages/jax/interpreters/ad.py", line 116, in vjp
    out_primals, pvals, jaxpr, consts = linearize(traceable, *primals)
  File "/usr/local/lib/python3.7/dist-packages/jax/interpreters/ad.py", line 103, in linearize
    jaxpr, out_pvals, consts = pe.trace_to_jaxpr(jvpfun_flat, in_pvals)
  File "/usr/local/lib/python3.7/dist-packages/jax/interpreters/partial_eval.py", line 513, in trace_to_jaxpr
    jaxpr, (out_pvals, consts, env) = fun.call_wrapped(pvals)
  File "/usr/local/lib/python3.7/dist-packages/jax/linear_util.py", line 179, in call_wrapped
    ans = gen.send(ans)
  File "/usr/local/lib/python3.7/dist-packages/jax/interpreters/partial_eval.py", line 534, in trace_to_subjaxpr
    jaxpr, consts, env = tracers_to_jaxpr(in_tracers, out_tracers)
  File "/usr/local/lib/python3.7/dist-packages/jax/interpreters/partial_eval.py", line 633, in tracers_to_jaxpr
    eqns.append(recipe_to_eqn(getvar, recipe))
  File "/usr/local/lib/python3.7/dist-packages/jax/interpreters/partial_eval.py", line 591, in recipe_to_eqn
    else cast(Var, getvar(t)) for t in out_tracers]
  File "/usr/local/lib/python3.7/dist-packages/jax/interpreters/partial_eval.py", line 591, in <listcomp>
    else cast(Var, getvar(t)) for t in out_tracers]
  File "/usr/local/lib/python3.7/dist-packages/jax/interpreters/partial_eval.py", line 615, in getvar
    var = t_to_var[id(t)] = newvar(aval)
  File "/usr/local/lib/python3.7/dist-packages/jax/core.py", line 208, in <lambda>
    return lambda aval: Var(next(counter), suffix, aval)
  File "/usr/local/lib/python3.7/dist-packages/jax/core.py", line 172, in __init__
    self.aval = raise_to_shaped(aval)
  File "/usr/local/lib/python3.7/dist-packages/jax/core.py", line 1243, in raise_to_shaped
    if handler: return handler(aval, weak_type)
  File "/usr/local/lib/python3.7/dist-packages/jax/core.py", line 1252, in <lambda>
    aval.shape, aval.dtype, weak_type, aval.named_shape)
  File "/usr/local/lib/python3.7/dist-packages/jax/core.py", line 1093, in __init__
    super().__init__(dtype, weak_type=weak_type)
  File "/usr/local/lib/python3.7/dist-packages/jax/core.py", line 1027, in __init__
    self.dtype = np.dtype(dtypes.canonicalize_dtype(dtype))
  File "/usr/local/lib/python3.7/dist-packages/jax/_src/util.py", line 201, in wrapper
    return memoized(config._trace_context(), *args, **kwargs)
KeyboardInterrupt